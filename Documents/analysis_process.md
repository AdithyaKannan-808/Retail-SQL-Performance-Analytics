#  Analysis Process

This document outlines the end-to-end SQL workflow used to build the Retail Sales Performance Analytics pipeline.  
The analysis includes data integration, monthly aggregation, target modelling, variance computation, and ranking logic.

---

## 1️ Data Integration (vw_orders_full)

The first step was to unify data from three different tables:

- **orders**  
- **returned**  
- **people**

Key logic applied:

- Created `is_returned` flag:  
  - If `order_id` exists in returned → 1  
  - Else check if orders.returns contains values like “Yes”, “Returned”, “1”  
- Standardized salesperson names using `UPPER(TRIM())`  
- Added `sales_person_region` from people table  

This produced the primary analytical view: **vw_orders_full**.  

---

## 2️ Monthly Aggregation (vw_monthly_actuals)

From the unified data, monthly performance was generated by:

- Grouping data per salesperson per month (`YYYY-MM`)  
- Summing revenue and profit  
- Formatting dates using `DATE_FORMAT(order_date, '%Y-%m')`  
- Cleaning salesperson names for consistent grouping  

This resulted in **vw_monthly_actuals**, the foundation for target modelling.  

---

## 3️ Target Modelling (+3% Growth)

To simulate a realistic business scenario, the project generated monthly targets:
target = previous_month_actual × 1.03


Steps:

1. Derived “next month” for each entry using `DATE_ADD(...)`  
2. Aggregated values to avoid duplicate keys  
3. Inserted results into **sales_target_monthly**  
4. Ensured a unique primary key: `(sales_person, month_yyyymm)`  

This builds scalable targets for any number of salespeople.  


---

## 4️ Performance Attainment (vw_target_attainment)

The final analytical view combines actuals and targets to compute:

- Revenue variance %  
- Profit variance %  
- Performance classification:  
  - **Overachiever** (>= +2%)  
  - **On Target** (-2% to +2%)  
  - **Underperformer** (< -2%)  
- Monthly ranking using window functions:

RANK() OVER (PARTITION BY month_yyyymm ORDER BY profit_actual DESC)


This view is the main output for leaderboards, dashboards, or reporting.  


---

## 5️ KPI & Trend Analysis

Additional queries extracted:

- Total sales and profit  
- Return rate (%)  
- Average discount  
- Monthly sales/profit trends  
- Category-wise return behaviour  
- Salesperson profit leaderboard  

These queries provide business-ready insights for performance evaluation.  


---

##  Summary

This SQL workflow converts raw retail data into a complete performance intelligence system.  
Through clean views, target modelling, variance logic, and ranking, it replicates real business reporting processes inside SQL.


